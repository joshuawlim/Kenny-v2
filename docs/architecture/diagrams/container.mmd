%% Container diagram for Kenny v2
flowchart TB
  User((User))

  subgraph LocalHost[Local Machine]
    WebUI[Web Chat UI]
    Engine[Agent Engine]
    ETL[ETL Pipelines (Mail/WhatsApp/iMessage)]
    KB[Contacts Knowledge Base]
    Search[Search & Embeddings]
    Memory[Memory Learning]
    Dashboard[Observability Dashboard]
  end

  %% External Services (egress controlled by allowlist per ADR-0012)
  WhatsApp[WhatsApp]
  AppleMail[Apple Mail]
  iMessage[iMessage]
  Calendar[Apple Calendar]

  User --> WebUI
  WebUI --> Engine
  Engine --> ETL
  Engine --> Search
  Engine --> Memory
  Engine --> KB
  Engine --> Dashboard

  ETL --- WhatsApp
  ETL --- AppleMail
  ETL --- iMessage
  Engine --- Calendar